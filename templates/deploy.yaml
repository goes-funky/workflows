# Dependencies: templates/common/deploy.yaml templates/common/ssh-agent.yaml
name: Deploy
fragments:
  step-setup-ssh-agent: &step-setup-ssh-agent
on:
jobs:
  # build from master branch or tagged release
  build:
    if: "github.event.ref == 'refs/heads/master' || startsWith(github.event.ref, 'refs/tags/v')"
  # deploy to development from master branch or tagged release
  deploy-development:
    if: "!inputs.skip-deploy && (github.event.ref == 'refs/heads/master' || startsWith(github.event.ref, 'refs/tags/v'))"
  # deploy to production from tagged release
  deploy-production:
    if: "!inputs.skip-deploy && startsWith(github.event.ref, 'refs/tags/v')"